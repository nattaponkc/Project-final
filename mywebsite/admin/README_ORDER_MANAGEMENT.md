# ระบบจัดการคำสั่งซื้อ (Order Management System)

## ฟีเจอร์หลัก

### 1. แสดงรายการคำสั่งซื้อ
- แสดงข้อมูลลูกค้า (ชื่อ, เบอร์โทร, อีเมล)
- แสดงวันที่สั่งซื้อและเวลารับ
- แสดงยอดรวมคำสั่งซื้อ
- แสดงสถานะคำสั่งซื้อ
- แสดงสลิปการชำระเงิน

### 2. รายละเอียดสินค้า
- **สินค้า**: ชื่อสินค้าพร้อมรูปภาพ
- **ประเภท**: ประเภทของสินค้า (กาแฟ, น้ำปั่น, อาหาร, ขนม, เมล็ดกาแฟ)
- **ประเภทราคา**: ประเภทราคา (ร้อน, เย็น, เฟรปเป้)
- **ราคา**: ราคาต่อหน่วย
- **จำนวน**: จำนวนที่สั่งซื้อ
- **รวม**: ราคารวมของสินค้านั้น

### 3. การจัดการคำสั่งซื้อ
- **ดูรายละเอียด**: ดูข้อมูลลูกค้าและรายการสินค้าทั้งหมด
- **แก้ไขสถานะ**: อัปเดตสถานะคำสั่งซื้อและหมายเหตุ
- **ตอบกลับลูกค้า**: ส่งข้อความตอบกลับลูกค้าพร้อมส่งอีเมลแจ้งเตือน

### 4. สถานะคำสั่งซื้อ
- รอดำเนินการ (สีเหลือง)
- กำลังทำ (สีน้ำเงิน)
- เสร็จสิ้น (สีเขียว)
- ยกเลิก (สีแดง)

### 5. ฟีเจอร์เพิ่มเติม
- **ส่งออก Excel**: ดาวน์โหลดรายการคำสั่งซื้อเป็นไฟล์ Excel
- **พิมพ์**: พิมพ์รายการคำสั่งซื้อ
- **ค้นหาและกรอง**: ใช้ DataTables สำหรับค้นหาและเรียงลำดับ

## ไฟล์ที่เกี่ยวข้อง

### ไฟล์หลัก
- `order_list.php` - หน้าจัดการคำสั่งซื้อหลัก
- `order_status_update.php` - อัปเดตสถานะคำสั่งซื้อ
- `order_reply.php` - ตอบกลับลูกค้าและส่งอีเมล
- `print.css` - CSS สำหรับการพิมพ์

### ฐานข้อมูล
- `tbl_order` - ตารางคำสั่งซื้อ
- `tbl_order_item` - รายการสินค้าในคำสั่งซื้อ
- `tbl_product` - ข้อมูลสินค้า
- `tbl_type` - ประเภทสินค้า
- `tbl_member` - ข้อมูลลูกค้า

## การใช้งาน

### 1. ดูรายการคำสั่งซื้อ
1. เข้าสู่หน้า "จัดการคำสั่งซื้อ"
2. ดูรายการคำสั่งซื้อทั้งหมดในตาราง
3. ใช้ฟิลเตอร์ค้นหาและเรียงลำดับตามต้องการ

### 2. ดูรายละเอียดคำสั่งซื้อ
1. คลิกปุ่ม "ดู" (ไอคอนตา) ในแถวที่ต้องการ
2. ดูข้อมูลลูกค้าและรายการสินค้าทั้งหมด
3. ดูหมายเหตุจากลูกค้าและแอดมิน

### 3. แก้ไขสถานะคำสั่งซื้อ
1. คลิกปุ่ม "แก้ไข" (ไอคอนดินสอ)
2. เลือกสถานะใหม่
3. เพิ่มหมายเหตุ (ถ้ามี)
4. คลิก "บันทึก"

### 4. ตอบกลับลูกค้า
1. คลิกปุ่ม "ตอบกลับ" (ไอคอนตอบกลับ)
2. กรอกหัวข้อและข้อความ
3. เลือกส่งอีเมลแจ้งเตือน (ถ้าต้องการ)
4. คลิก "ส่งข้อความ"

### 5. ส่งออกข้อมูล
1. คลิกปุ่ม "ส่งออก Excel" เพื่อดาวน์โหลดไฟล์ Excel
2. คลิกปุ่ม "พิมพ์" เพื่อพิมพ์รายการ

## การตั้งค่า

### 1. การส่งอีเมล
แก้ไขการตั้งค่าใน `order_reply.php`:
```php
$headers .= "From: noreply@yourwebsite.com" . "\r\n";
```

### 2. การเชื่อมต่อฐานข้อมูล
ตรวจสอบการตั้งค่าใน `../config/condb.php`

### 3. การอัปเดตสถานะ
สถานะที่รองรับ:
- รอดำเนินการ
- กำลังทำ
- เสร็จสิ้น
- ยกเลิก

## ข้อควรระวัง

1. **สิทธิ์การเข้าถึง**: ตรวจสอบว่าผู้ใช้มีสิทธิ์เข้าถึงหน้าแอดมิน
2. **การส่งอีเมล**: ตรวจสอบการตั้งค่า SMTP ของเซิร์ฟเวอร์
3. **ฐานข้อมูล**: ตรวจสอบการเชื่อมต่อฐานข้อมูลและโครงสร้างตาราง
4. **ไฟล์รูปภาพ**: ตรวจสอบสิทธิ์การเข้าถึงโฟลเดอร์รูปภาพ

## การแก้ไขปัญหา

### ปัญหาที่พบบ่อย

1. **ไม่แสดงข้อมูลสินค้า**
   - ตรวจสอบการเชื่อมต่อตาราง `tbl_order_item`
   - ตรวจสอบข้อมูลในตาราง `tbl_product` และ `tbl_type`

2. **ไม่สามารถส่งอีเมลได้**
   - ตรวจสอบการตั้งค่า SMTP
   - ตรวจสอบฟังก์ชัน `mail()` ของ PHP

3. **ไม่สามารถอัปเดตสถานะได้**
   - ตรวจสอบสิทธิ์การเขียนฐานข้อมูล
   - ตรวจสอบการเชื่อมต่อฐานข้อมูล

4. **รูปภาพไม่แสดง**
   - ตรวจสอบเส้นทางไฟล์รูปภาพ
   - ตรวจสอบสิทธิ์การเข้าถึงโฟลเดอร์

## การพัฒนาต่อ

### ฟีเจอร์ที่สามารถเพิ่มได้
1. การแจ้งเตือนผ่าน LINE Notify
2. การส่ง SMS แจ้งเตือน
3. การสร้างรายงานสถิติ
4. การจัดการสต็อกสินค้า
5. การสร้าง QR Code สำหรับติดตามคำสั่งซื้อ 